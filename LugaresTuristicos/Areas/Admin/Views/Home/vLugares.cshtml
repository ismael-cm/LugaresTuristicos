@model Lugare

<style>
    .profile-picture {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        margin-right: 10px;
    }
</style>



<div class="container-fluid">

    <div class="row">
        <h3>Mantenimiento de Lugares</h3>

        <div class="d-grid gap-2 d-md-flex justify-content-md-end mb-3">
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal" id="agregar">Nuevo registro</button>
        </div>
        <br />
        <div class="col-md-12" id="contenido">
        </div>
    </div>
</div>

<!-- Modal agregar -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Agregando Lugar turistico</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="Form1" enctype="multipart/form-data" method="post">
                <div class="modal-body">
                    <div class="form-group mb-1">
                        <label asp-for="IdUsuario" class="control-label">Usuario</label>
                        <select asp-for="IdUsuario" class="form-control" required>
                            <option value="">Seleccione un usuario</option>
                            @foreach (Usuario usuario in ViewBag.Usuarios)
                            {
                                <option value="@usuario.IdUsuario">@usuario.Nombre @usuario.Apellido</option>
                            }
                        </select>
                        <span asp-validation-for="IdUsuario" class="text-danger"></span>
                    </div>
                    <div class="form-group mb-1">
                        <label asp-for="NombreLugar" class="control-label">Nombre del Lugar</label>
                        <input asp-for="NombreLugar" class="form-control" placeholder="Escribe el nombre" required />
                        <span asp-validation-for="NombreLugar" class="text-danger"></span>
                    </div>
                    <div class="form-floating">
                        <textarea class="form-control" placeholder="Escribe una descripcion" asp-for="Descripcion" required></textarea>
                        <label asp-for="Descripcion">Escribe la descripcion del lugar</label>
                    </div>
                    <div class="form-group mb-1">
                        <label class="control-label">Departamento</label>
                        <select id="idDepto" class="form-control" required>
                            <option value="">Seleccione un departamento</option>
                            @foreach (Departamento departamento in ViewBag.Departamento)
                            {
                                <option value="@departamento.IdDepto">@departamento.Departamento1</option>
                            }
                        </select>
                    </div>
                    <div class="form-group mb-1">
                        <label class="control-label">Municipio</label>
                        <select asp-for="IdMunicipio" class="form-control" required disabled>
                            <option value="">Seleccione un municipio</option>
                            @foreach (Municipio municipio in ViewBag.Municipio)
                            {
                                <option value="@municipio.IdMunicipio">@municipio.Municipio1</option>
                            }
                        </select>
                    </div>
                    <div class="form-group mb-1">
                        <label asp-for="Precio" class="control-label">Precio del Lugar</label>
                        <input asp-for="Precio" class="form-control" required />
                        <span asp-validation-for="Precio" class="text-danger"></span>

                        <label asp-for="Imagen" class="control-label">Imagen</label>
                        <input type="file" name="imagenArchivo" class="form-control" accept="image/jpeg, image/png, image/gif" asp-for="Imagen" />
                        <span asp-validation-for="Imagen" class="text-danger"></span>

                    </div>
                    <div class="form-group mb-1">
                        <label asp-for="IdCategoria" class="control-label">Categoria</label>
                        <select asp-for="IdCategoria" class="form-control" required>
                            <option value="">Seleccione una categoria</option>
                            @foreach (Categoria categoria in ViewBag.Categoria)
                            {
                                <option value="@categoria.IdCategoria">@categoria.NombreCategoria</option>
                            }
                        </select>
                        <span asp-validation-for="IdCategoria" class="text-danger"></span>
                    </div>
                    
                </div>
                <div class="modal-footer">
                    <button type="button" id="btnCerrar" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="submit" id="btnGuardar" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>
</div>


<!-- Modal actualizar -->
<div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel2">Modificando Lugar turistico</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="Form2" enctype="multipart/form-data" method="post">
                <div class="modal-body">
                    <div class="form-group mb-1">
                        <input id="idLugar" class="form-control" placeholder="Escribe el nombre" hidden required />
                    </div>
                    <div class="form-group mb-1">
                        <label class="control-label">Usuario</label>
                        <select id="IdUsuario2" class="form-control" required>
                            <option value="">Seleccione un usuario</option>
                            @foreach (Usuario usuario in ViewBag.Usuarios)
                            {
                                <option value="@usuario.IdUsuario">@usuario.Nombre @usuario.Apellido</option>
                            }
                        </select>
                    </div>
                    <div class="form-group mb-1">
                        <label class="control-label">Nombre del Lugar</label>
                        <input id="NombreLugar2" class="form-control" placeholder="Escribe el nombre" required />
                    </div>
                    <div class="form-floating">
                        <textarea class="form-control" placeholder="Escribe una descripcion" id="Descripcion2" required></textarea>
                        <label>Escribe la descripcion del lugar</label>
                    </div>
                    <div class="form-group mb-1">
                        <label class="control-label">Departamento</label>
                        <select id="idDepto2" class="form-control" required>
                            <option value="">Seleccione un departamento</option>
                            @foreach (Departamento departamento in ViewBag.Departamento)
                            {
                                <option value="@departamento.IdDepto">@departamento.Departamento1</option>
                            }
                        </select>
                    </div>
                    <div class="form-group mb-1">
                        <label class="control-label">Municipio</label>
                        <select id="IdMunicipio2" class="form-control" required>
                            <option value="">Seleccione un municipio</option>
                            @foreach (Municipio municipio in ViewBag.Municipio)
                            {
                                <option value="@municipio.IdMunicipio">@municipio.Municipio1</option>
                            }
                        </select>
                    </div>
                    <div class="form-group mb-1">
                        <label class="control-label">Precio del Lugar</label>
                        <input id="Precio2" class="form-control" required />

                        <label class="control-label">Imagen</label>
                        <input type="file" name="imagenArchivo" class="form-control" accept="image/jpeg, image/png, image/gif" id="Imagen2" disabled />

                    </div>
                    <div class="form-check form-switch d-grid gap-2 d-md-flex justify-content-md-end">
                        <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault">
                        <label class="form-check-label" for="flexSwitchCheckDefault">¿Desea modificar la imagen?</label>
                    </div>
                    <div class="form-group mb-1">
                        <label class="control-label">Categoria</label>
                        <select id="IdCategoria2" class="form-control" required>
                            <option value="">Seleccione una categoria</option>
                            @foreach (Categoria categoria in ViewBag.Categoria)
                            {
                                <option value="@categoria.IdCategoria">@categoria.NombreCategoria</option>
                            }
                        </select>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" id="btnCerrar2" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="submit" id="btnActualizar" class="btn btn-primary">Actualizar</button>
                </div>
            </form>
        </div>
    </div>
</div>






@section Scripts{
    <script>
        function cargarTabla() {
            $.ajax({
                url: '/admin/Home/getTablaLugares',
                type: 'post',
                dataType: 'json',
                cache: false
            }).done(function (resp) {
                console.log(resp);
                var div = $("#contenido");
                var tabla = "<table id='tabla' class='fw-light table table-striped table-hover'><thead class='table-dark'><tr><th>ID</th><th>Usuario</th><th>Nombre</th><th>Descripcion</th><th>Municipio</th><th>Departamento</th><th>Categoria</th><th>Precio</th><th>Imagen</th><th>Fecha</th><th>Acciones</th></tr></thead><tbody>";
                                
                $.each(resp, function (index, lugares) {

                    var img = 'data:image;base64,' + lugares.imagen;
                    var imagenHTML = "<img class='rounded-pill profile-picture' src='" + img + "'>";


                    tabla += "<tr>";
                    tabla += "<td>" + lugares.idLugar + "</td>";
                    tabla += "<td>" + lugares.user + "</td>";
                    tabla += "<td>" + lugares.nombre + "</td>";
                    tabla += "<td>" + lugares.descripcion + "</td>";
                    tabla += "<td>" + lugares.municipio + "</td>";
                    tabla += "<td>" + lugares.departamento + "</td>";
                    tabla += "<td>" + lugares.categoria + "</td>";
                    tabla += "<td>" + lugares.precio + "</td>";
                    tabla += "<td>" + imagenHTML + "</td>";
                    tabla += "<td>" + lugares.fecha + "</td>";

                    //var texto1 = lugares.user;
                    //var textomodificado1 = texto1.replace(/ /g, "-");

                    var texto2 = lugares.nombre;
                    var textomodificado2 = texto2.replace(/ /g, "-");

                    var texto3 = lugares.descripcion;
                    var textomodificado3 = texto3.replace(/ /g, "-");

                    console.log();
                    console.log();

                    tabla += "<td><a data-bs-toggle='modal' data-bs-target='#exampleModal2' class='fw-light btn btn-light' onclick=cargarUpt('" + lugares.idLugar + "," + lugares.idUser + "," + textomodificado2 + "," + textomodificado3 + "," + lugares.idMunicipio + "," + lugares.idDepto + "," + lugares.idCategoria + "," + lugares.precio2 + "') >Editar</a> | <a class='fw-light btn btn-danger' href=\"javascript:cargarDel('" + lugares.idLugar + "')\">Eliminar</a></td>";
                    tabla += "</tr>";
                });
                tabla += "</tbody></table>";
                div.empty();
                div.append(tabla);

                //$('#tabla').DataTable();

                var table = new DataTable('#tabla', {
                    language: {
                        url: '//cdn.datatables.net/plug-ins/1.13.4/i18n/es-ES.json',
                    },
                });

            }).fail();

        }

        function cargarDel(IdLugar) {
            const swalWithBootstrapButtons = Swal.mixin({
                customClass: {
                    confirmButton: 'btn btn-success',
                    cancelButton: 'btn btn-danger me-4'
                },
                buttonsStyling: false
            })

            swalWithBootstrapButtons.fire({
                title: 'Estas seguro?',
                text: "Una vez eliminado se pierde definitivamente!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: 'Confirmar',
                cancelButtonText: 'Cancelar',
                reverseButtons: true
            }).then((result) => {
                if (result.isConfirmed) {
                    $.ajax({
                        url: '@Url.Action("EliminarLugar", "Home")',
                        type: 'post',
                        dataType: 'json',
                        cache: false,
                        data: { id: IdLugar }
                    }).done(function (resp) {
                        if (resp) {
                            swalWithBootstrapButtons.fire(
                                'Eliminado!',
                                'Tu registro ha sido elimando.',
                                'success'
                            )
                            cargarTabla();
                        } else {
                            swalWithBootstrapButtons.fire(
                                'Cancelado',
                                'Se omitieron los datos',
                                'error'
                            )
                        }
                    }).fail();
                } else if (
                    result.dismiss === Swal.DismissReason.cancel
                ) {
                    swalWithBootstrapButtons.fire(
                        'Cancelado',
                        'Se han omitido los datos',
                        'error'
                    )
                }
            })
        }

        function cargarUpt(valor) {

            var obj = valor.split(',');
            var textoModificado1 = obj[2];
            var textoOriginal1 = textoModificado1.replace(/-/g, " ");

            var textoModificado2 = obj[3];
            var textoOriginal2 = textoModificado2.replace(/-/g, " ");


            document.getElementById("idLugar").value = obj[0];
            document.getElementById("IdUsuario2").value = obj[1];
            document.getElementById("NombreLugar2").value = textoOriginal1;
            document.getElementById("Descripcion2").value = textoOriginal2;
            document.getElementById("IdMunicipio2").value = obj[4];
            document.getElementById("idDepto2").value = obj[5];
            document.getElementById("IdCategoria2").value = obj[6];
            document.getElementById("Precio2").value = obj[7];
            

        }

        function limpiarCajas() {
            document.getElementById("IdUsuario").value = "";
            document.getElementById("NombreLugar").value = "";
            document.getElementById("Descripcion").value = "";
            document.getElementById("idDepto").value = "";
            document.getElementById("IdMunicipio").value = "";
            document.getElementById("Precio").value = "";
            document.getElementById("Imagen").value = "";
            document.getElementById("IdCategoria").value = "";
        }

        function limpiarClases() {
            document.getElementById("IdUsuario").classList.remove("is-valid");
            document.getElementById("NombreLugar").classList.remove("is-valid");
            document.getElementById("Descripcion").classList.remove("is-valid");
            document.getElementById("idDepto").classList.remove("is-valid");
            document.getElementById("IdMunicipio").classList.remove("is-valid");
            document.getElementById("Precio").classList.remove("is-valid");
            document.getElementById("Imagen").classList.remove("is-valid");
            document.getElementById("IdCategoria").classList.remove("is-valid");

            document.getElementById("IdUsuario").classList.remove("is-invalid");
            document.getElementById("NombreLugar").classList.remove("is-invalid");
            document.getElementById("Descripcion").classList.remove("is-invalid");
            document.getElementById("idDepto").classList.remove("is-invalid");
            document.getElementById("IdMunicipio").classList.remove("is-invalid");
            document.getElementById("Precio").classList.remove("is-invalid");
            document.getElementById("Imagen").classList.remove("is-invalid");
            document.getElementById("IdCategoria").classList.remove("is-invalid");

            document.getElementById("IdUsuario2").classList.remove("is-valid");
            document.getElementById("NombreLugar2").classList.remove("is-valid");
            document.getElementById("Descripcion2").classList.remove("is-valid");
            document.getElementById("idDepto2").classList.remove("is-valid");
            document.getElementById("IdMunicipio2").classList.remove("is-valid");
            document.getElementById("Precio2").classList.remove("is-valid");
            document.getElementById("Imagen2").classList.remove("is-valid");
            document.getElementById("IdCategoria2").classList.remove("is-valid");

            document.getElementById("IdUsuario2").classList.remove("is-invalid");
            document.getElementById("NombreLugar2").classList.remove("is-invalid");
            document.getElementById("Descripcion2").classList.remove("is-invalid");
            document.getElementById("idDepto2").classList.remove("is-invalid");
            document.getElementById("IdMunicipio2").classList.remove("is-invalid");
            document.getElementById("Precio2").classList.remove("is-invalid");
            document.getElementById("Imagen2").classList.remove("is-invalid");
            document.getElementById("IdCategoria2").classList.remove("is-invalid");
        }


        $(document).ready(function () {

            const radioInput = document.getElementById('flexSwitchCheckDefault');
            const fileInput = document.getElementById('Imagen2');

            radioInput.addEventListener('change', function () {
                if (radioInput.checked) {
                    fileInput.disabled = false;
                } else {
                    fileInput.disabled = true;
                    document.getElementById("Imagen2").value = "";
                }
            });

            $("#idDepto").change(function () {
                var selectedValue = $(this).val();
                if(selectedValue != ""){

                    document.getElementById("IdMunicipio").removeAttribute("disabled");
                    var idDepto = $("#idDepto").val();
                    $("#IdMunicipio").empty();
                    $("#IdMunicipio").append('<option value="">' + "Seleccione un municipio" + '</option>');

                    $.ajax({
                        type: "post",
                        url: '@Url.Action("getTablaMunicipioByIdDepto","Home")',
                        cache: false,
                        dataType: 'json',
                        data: { id: selectedValue }
                    }).done(function (resp){
                        $.each(resp, function (index, muni){
                            $("#IdMunicipio").append('<option value="' + muni.id_muni + '">' + muni.municipio + '</option>');
                        });
                    });
                }else{
                    document.getElementById("IdMunicipio").classList.remove("is-invalid");
                    document.getElementById("IdMunicipio").classList.remove("is-valid");
                    $("#IdMunicipio").empty();
                    $("#IdMunicipio").append('<option value="">' + "Seleccione un municipio" + '</option>');
                    document.getElementById("IdMunicipio").setAttribute("disabled", "disabled");
                }
            });

            $("#idDepto2").change(function () {
                var selectedValue = $(this).val();
                if (selectedValue != "") {

                    document.getElementById("IdMunicipio2").removeAttribute("disabled");
                    var idDepto2 = $("#idDepto2").val();
                    $("#IdMunicipio2").empty();
                    $("#IdMunicipio2").append('<option value="">' + "Seleccione un municipio" + '</option>');

                    $.ajax({
                        type: "post",
                        url: '@Url.Action("getTablaMunicipioByIdDepto","Home")',
                        cache: false,
                        dataType: 'json',
                        data: { id: selectedValue }
                    }).done(function (resp) {
                        $.each(resp, function (index, muni) {
                            $("#IdMunicipio2").append('<option value="' + muni.id_muni + '">' + muni.municipio + '</option>');
                        });
                    });
                } else {
                    document.getElementById("IdMunicipio2").classList.remove("is-invalid");
                    document.getElementById("IdMunicipio2").classList.remove("is-valid");
                    $("#IdMunicipio2").empty();
                    $("#IdMunicipio2").append('<option value="">' + "Seleccione un municipio" + '</option>');
                    document.getElementById("IdMunicipio2").setAttribute("disabled", "disabled");
                }
            });


            $('#Form1').submit(function (event) {
                event.preventDefault();

                var formData = new FormData();
                var inputsInvalidos = $("#Form1 .is-invalid").length;
                var idUser = $("#IdUsuario").val();
                var nombre = $("#NombreLugar").val();
                var desc = $("#Descripcion").val();
                var muni = $("#IdMunicipio").val();
                var prec = $("#Precio").val();
                var cat = $("#IdCategoria").val();
                

                if(idUser != "" && nombre != "" && desc != ""
                   && muni != "" && prec != "" && cat != ""){

                    var lugaresObj = {
                        IdUsuario: idUser,
                        IdCategoria: cat,
                        NombreLugar: nombre,
                        Descripcion: desc,
                        IdMunicipio: muni,
                        Precio: prec
                    };

                    if(inputsInvalidos === 0){
                        formData.append('imageFile', $('#Imagen')[0].files[0]);
                        formData.append('lugaresObj', JSON.stringify(lugaresObj));

                        $.ajax({
                            url: '/admin/Home/UploadImage',
                            type: 'POST',
                            data: formData,
                            processData: false,
                            contentType: false
                        }).done(function (resp) {
                            if (resp) {
                                Swal.fire({
                                    title: 'El registro ha sido agregado correctamente',
                                    icon: 'success',
                                    confirmButtonText: 'Continuar'
                                })
                                cargarTabla();
                                $("#btnCerrar").click();
                                limpiarCajas();
                                limpiarClases();
                            } else {
                                Swal.fire({
                                    title: 'Hubo un error al momento de agregar el dato',
                                    icon: 'error',
                                    confirmButtonText: 'Continuar'
                                })
                            }
                        }).fail(function () {
                            Swal.fire({
                                title: 'Hubo un error al momento de agregar el dato',
                                icon: 'error',
                                confirmButtonText: 'Continuar'
                            })
                        });;

                    }else{
                        Swal.fire({
                            title: 'Verifica los textos en rojo para continuar',
                            icon: 'error',
                            confirmButtonText: 'Continuar'
                        })
                    }
                }else{
                    Swal.fire({
                        title: 'Todos los campos son obligatorios',
                        icon: 'warning',
                        confirmButtonText: 'OK'
                    })
                }
            });

            $('#Form2').submit(function (event) {
                event.preventDefault();

                var formData = new FormData();
                var inputsInvalidos = $("#Form2 .is-invalid").length;
                var idUser = $("#IdUsuario2").val();
                var idluga = $("#idLugar").val();
                var nombr = $("#NombreLugar2").val();
                var desc = $("#Descripcion2").val();
                var muni = $("#IdMunicipio2").val();
                var prec = $("#Precio2").val();
                var cat = $("#IdCategoria2").val();
                var formulario = $("#Form2").serialize();
                var im = $("#Imagen2").val();

                if (!radioInput.checked) {
                    if (idUser != "" && nombr != "" && desc != ""
                        && muni != "" && prec != "" && cat != "") {

                        if (inputsInvalidos === 0) {
                            $.ajax({
                                url: '@Url.Action("ActualizarLugarSinImagen","Home")',
                                type: 'post',
                                cache: false,
                                dataType: 'json',
                                data: { id_lugar: idluga, id_usuario: idUser, id_categoria: cat, nombre: nombr, descripcion: desc, id_municipio: muni, precio: prec }
                            }).done(function (resp) {
                                if (resp) {
                                    Swal.fire({
                                        title: 'El registro ha sido agregado correctamente',
                                        icon: 'success',
                                        confirmButtonText: 'Continuar'
                                    })
                                    cargarTabla();
                                    $("#btnCerrar2").click();
                                    limpiarCajas();
                                    limpiarClases();
                                } else {
                                    Swal.fire({
                                        title: 'Hubo un error al momento de agregar el dato',
                                        icon: 'error',
                                        confirmButtonText: 'Continuar'
                                    })
                                }
                            }).fail(function () {
                                Swal.fire({
                                    title: 'Hubo un error al momento de agregar el dato',
                                    icon: 'error',
                                    confirmButtonText: 'Continuar'
                                })
                            });;

                        } else {
                            Swal.fire({
                                title: 'Verifica los textos en rojo para continuar',
                                icon: 'error',
                                confirmButtonText: 'Continuar'
                            })
                        }
                    } else {
                        Swal.fire({
                            title: 'Todos los campos son obligatorios',
                            icon: 'warning',
                            confirmButtonText: 'OK'
                        })
                    }
                }else{
                    if (idUser != "" && nombr != "" && desc != ""
                        && muni != "" && prec != "" && cat != "" && im != "") {

                        var lugaresObj = {
                            IdUsuario: idUser,
                            IdLugar: idluga,
                            IdCategoria: cat,
                            NombreLugar: nombr,
                            Descripcion: desc,
                            IdMunicipio: muni,
                            Precio: prec
                        };

                        if (inputsInvalidos === 0) {
                            formData.append('imageFile', $('#Imagen2')[0].files[0]);
                            formData.append('lugaresObj', JSON.stringify(lugaresObj));

                            $.ajax({
                                url: '/admin/Home/UploadImageUpdate',
                                type: 'POST',
                                data: formData,
                                processData: false,
                                contentType: false
                            }).done(function (resp) {
                                if (resp) {
                                    Swal.fire({
                                        title: 'El registro ha sido agregado correctamente',
                                        icon: 'success',
                                        confirmButtonText: 'Continuar'
                                    })
                                    cargarTabla();
                                    $("#btnCerrar2").click();
                                    limpiarCajas();
                                    limpiarClases();
                                    radioInput.checked = false;
                                    fileInput.disabled = true;
                                    document.getElementById("Imagen2").value = "";
                                } else {
                                    Swal.fire({
                                        title: 'Hubo un error al momento de agregar el dato',
                                        icon: 'error',
                                        confirmButtonText: 'Continuar'
                                    })
                                }
                            }).fail(function () {
                                Swal.fire({
                                    title: 'Hubo un error al momento de agregar el dato',
                                    icon: 'error',
                                    confirmButtonText: 'Continuar'
                                })
                            });;

                        } else {
                            Swal.fire({
                                title: 'Verifica los textos en rojo para continuar',
                                icon: 'error',
                                confirmButtonText: 'Continuar'
                            })
                        }
                    } else {
                        Swal.fire({
                            title: 'Todos los campos son obligatorios',
                            icon: 'warning',
                            confirmButtonText: 'OK'
                        })
                    }
                }

            });

            // -----------------
            var selectUsuario = document.getElementById("IdUsuario");
            selectUsuario.addEventListener("change", function () {
                if (selectUsuario.value !== "") {
                    selectUsuario.classList.add("is-valid");
                    selectUsuario.classList.remove("is-invalid");
                } else {
                    selectUsuario.classList.add("is-invalid");
                    selectUsuario.classList.remove("is-valid");
                }
            });

            var inputNombre = document.getElementById("NombreLugar");
            function validarNombre() {

                var valor = inputNombre.value.trim();
                if (valor.length >= 4) {
                    inputNombre.classList.add("is-valid");
                    inputNombre.classList.remove("is-invalid");
                } else {
                    inputNombre.classList.add("is-invalid");
                    inputNombre.classList.remove("is-valid");
                }
            }

            inputNombre.addEventListener("keypress", function () {
                validarNombre();
            });

            inputNombre.addEventListener("keydown", function () {
                setTimeout(validarNombre, 0);
            });

            var inputDescripcion = document.getElementById("Descripcion");
            function validarDescripcion() {

                var valor = inputDescripcion.value.trim();
                if (valor.length >= 4) {
                    inputDescripcion.classList.add("is-valid");
                    inputDescripcion.classList.remove("is-invalid");
                } else {
                    inputDescripcion.classList.add("is-invalid");
                    inputDescripcion.classList.remove("is-valid");
                }
            }

            inputDescripcion.addEventListener("keypress", function () {
                validarDescripcion();
            });

            inputDescripcion.addEventListener("keydown", function () {
                setTimeout(validarDescripcion, 0);
            });

            var selectDepto = document.getElementById("idDepto");
            selectDepto.addEventListener("change", function () {
                if (selectDepto.value !== "") {
                    selectDepto.classList.add("is-valid");
                    selectDepto.classList.remove("is-invalid");
                } else {
                    selectDepto.classList.add("is-invalid");
                    selectDepto.classList.remove("is-valid");
                }
            });

            var selectMunicipio = document.getElementById("IdMunicipio");
            selectMunicipio.addEventListener("change", function () {
                if (selectMunicipio.value !== "") {
                    selectMunicipio.classList.add("is-valid");
                    selectMunicipio.classList.remove("is-invalid");
                } else {
                    selectMunicipio.classList.add("is-invalid");
                    selectMunicipio.classList.remove("is-valid");
                }
            });

            var selectCategoria = document.getElementById("IdCategoria");
            selectCategoria.addEventListener("change", function () {
                if (selectCategoria.value !== "") {
                    selectCategoria.classList.add("is-valid");
                    selectCategoria.classList.remove("is-invalid");
                } else {
                    selectCategoria.classList.add("is-invalid");
                    selectCategoria.classList.remove("is-valid");
                }
            });

            const inputPrecio = document.getElementById('Precio');

            inputPrecio.addEventListener('input', function () {
                let valor = inputPrecio.value;
                const tieneSimboloNegativo = valor.includes('-');

                valor = valor.replace(/[^0-9.-]/g, '');

                const signoPositivo = valor.indexOf('+');
                const signoNegativo = valor.indexOf('-');
                if (signoPositivo !== -1 && signoPositivo !== valor.lastIndexOf('+')) {
                    valor = valor.slice(0, signoPositivo) + valor.slice(signoPositivo + 1);
                }
                if (signoNegativo !== -1 && signoNegativo !== valor.lastIndexOf('-')) {
                    valor = valor.slice(0, signoNegativo) + valor.slice(signoNegativo + 1);
                }

                if (valor !== inputPrecio.value) {
                    inputPrecio.value = valor;
                    inputPrecio.classList.add('is-invalid');
                    inputPrecio.classList.remove('is-valid');
                }else{
                    inputPrecio.classList.add('is-valid');
                    inputPrecio.classList.remove('is-invalid');
                }

                if (tieneSimboloNegativo) {
                    inputPrecio.classList.add('is-invalid');
                    inputPrecio.classList.remove('is-valid');
                } else {
                    inputPrecio.classList.add('is-valid');
                    inputPrecio.classList.remove('is-invalid');
                }

                if(valor === ""){
                    inputPrecio.classList.add('is-invalid');
                    inputPrecio.classList.remove('is-valid');
                }

            });

            var inputImagen = document.getElementById("Imagen");
            inputImagen.addEventListener('change', function () {

                if (inputImagen.files.length > 0) {
                    inputImagen.classList.add('is-valid');
                    inputImagen.classList.remove('is-invalid');
                } else {
                    inputImagen.classList.add('is-invalid');
                    inputImagen.classList.remove('is-valid');
                }
            });

            //----------------
            var selectUsuario2 = document.getElementById("IdUsuario2");
            selectUsuario2.addEventListener("change", function () {
                if (selectUsuario2.value !== "") {
                    selectUsuario2.classList.add("is-valid");
                    selectUsuario2.classList.remove("is-invalid");
                } else {
                    selectUsuario2.classList.add("is-invalid");
                    selectUsuario2.classList.remove("is-valid");
                }
            });

            var inputNombre2 = document.getElementById("NombreLugar2");
            function validarNombre2() {

                var valor = inputNombre2.value.trim();
                if (valor.length >= 4) {
                    inputNombre2.classList.add("is-valid");
                    inputNombre2.classList.remove("is-invalid");
                } else {
                    inputNombre2.classList.add("is-invalid");
                    inputNombre2.classList.remove("is-valid");
                }
            }

            inputNombre2.addEventListener("keypress", function () {
                validarNombre2();
            });

            inputNombre2.addEventListener("keydown", function () {
                setTimeout(validarNombre2, 0);
            });

            var inputDescripcion2 = document.getElementById("Descripcion2");
            function validarDescripcion2() {

                var valor = inputDescripcion2.value.trim();
                if (valor.length >= 4) {
                    inputDescripcion2.classList.add("is-valid");
                    inputDescripcion2.classList.remove("is-invalid");
                } else {
                    inputDescripcion2.classList.add("is-invalid");
                    inputDescripcion2.classList.remove("is-valid");
                }
            }

            inputDescripcion2.addEventListener("keypress", function () {
                validarDescripcion2();
            });

            inputDescripcion2.addEventListener("keydown", function () {
                setTimeout(validarDescripcion2, 0);
            });

            var selectDepto2 = document.getElementById("idDepto2");
            selectDepto2.addEventListener("change", function () {
                if (selectDepto2.value !== "") {
                    selectDepto2.classList.add("is-valid");
                    selectDepto2.classList.remove("is-invalid");
                } else {
                    selectDepto2.classList.add("is-invalid");
                    selectDepto2.classList.remove("is-valid");
                }
            });

            var selectMunicipio2 = document.getElementById("IdMunicipio2");
            selectMunicipio2.addEventListener("change", function () {
                if (selectMunicipio2.value !== "") {
                    selectMunicipio2.classList.add("is-valid");
                    selectMunicipio2.classList.remove("is-invalid");
                } else {
                    selectMunicipio2.classList.add("is-invalid");
                    selectMunicipio2.classList.remove("is-valid");
                }
            });

            var selectCategoria2 = document.getElementById("IdCategoria2");
            selectCategoria2.addEventListener("change", function () {
                if (selectCategoria2.value !== "") {
                    selectCategoria2.classList.add("is-valid");
                    selectCategoria2.classList.remove("is-invalid");
                } else {
                    selectCategoria2.classList.add("is-invalid");
                    selectCategoria2.classList.remove("is-valid");
                }
            });

            const inputPrecio2 = document.getElementById('Precio2');

            inputPrecio2.addEventListener('input', function () {
                let valor2 = inputPrecio2.value;
                const tieneSimboloNegativo2 = valor2.includes('-');

                valor2 = valor2.replace(/[^0-9.-]/g, '');

                const signoPositivo2 = valor2.indexOf('+');
                const signoNegativo2 = valor2.indexOf('-');
                if (signoPositivo2 !== -1 && signoPositivo2 !== valor2.lastIndexOf('+')) {
                    valor2 = valor2.slice(0, signoPositivo2) + valor2.slice(signoPositivo2 + 1);
                }
                if (signoNegativo2 !== -1 && signoNegativo2 !== valor2.lastIndexOf('-')) {
                    valor2 = valor2.slice(0, signoNegativo2) + valor2.slice(signoNegativo2 + 1);
                }

                if (valor2 !== inputPrecio2.value) {
                    inputPrecio2.value = valor2;
                    inputPrecio2.classList.add('is-invalid');
                    inputPrecio2.classList.remove('is-valid');
                } else {
                    inputPrecio2.classList.add('is-valid');
                    inputPrecio2.classList.remove('is-invalid');
                }

                if (tieneSimboloNegativo2) {
                    inputPrecio2.classList.add('is-invalid');
                    inputPrecio2.classList.remove('is-valid');
                } else {
                    inputPrecio2.classList.add('is-valid');
                    inputPrecio2.classList.remove('is-invalid');
                }

                if (valor2 === "") {
                    inputPrecio2.classList.add('is-invalid');
                    inputPrecio2.classList.remove('is-valid');
                }

            });

            var inputImagen2 = document.getElementById("Imagen2");
            inputImagen2.addEventListener('change', function () {

                if (inputImagen2.files.length > 0) {
                    inputImagen2.classList.add('is-valid');
                    inputImagen2.classList.remove('is-invalid');
                } else {
                    inputImagen2.classList.add('is-invalid');
                    inputImagen2.classList.remove('is-valid');
                }
            });

            cargarTabla();

            
        });
    </script>

}